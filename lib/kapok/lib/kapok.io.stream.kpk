(defns kapok.io.stream-error
  ((require file
            (kapok (access
                    io)))
   (use (io_lib :only (format))))

  (defexception [{#reason :nil}
                 {#message :nil}])

  (defn
      #{:check_remote_call :false}
      exception [opts]
    (let [reason (access.get opts #reason)
          formatted (io.iodata-to-binary (file.format_error reason))
          message (format "error during streaming: ~p" [formatted])]
      (new :message message))))
